apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  namespace: nginx
spec:
  selector:
    matchLabels:
      app: nginx
  replicas: 2 # tells deployment to run 2 pods matching the template
  template:
    metadata:
      labels:
        app: nginx  # this is the label given to this pod and will be used in selecting this pod
    spec:
      containers:
      - name: nginx
        image: nginx:1.14.2
        ports:
        - containerPort: 80
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment1
  namespace: nginx
spec:
  selector:
    matchLabels:
      app: nginx1
  replicas: 2 # tells deployment to run 2 pods matching the template
  template:
    metadata:
      labels:
        app: nginx1
    spec:
      containers:
      - name: nginx1
        image: nginx:1.14.2
        ports:
        - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: nginx-service
  namespace: nginx
spec:
  selector:
   app: nginx   # the label given in templete is called here and refernced to te pod with same label when another pod have to communicate with that pod it can communicate with this svc
                # ex telnet nginx-service 80 or curl nginx-service:80 from nginx-deployment1 will connect to pod from nginx-deployment 
                # example for pod to pod communication
  ports:
   - name: nginx-service
     protocol: TCP
     port: 80
     targetPort: 80
     nodePort: 32011
  type: NodePort

